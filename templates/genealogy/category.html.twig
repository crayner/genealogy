{% trans_default_domain 'messages' %}

{% extends "base.html.twig" %}
{% block title %}{{  'Genealogy Modify Category'|trans }}{% endblock %}
{% block stylesheets %}
    {{ parent() }}
{% endblock stylesheets %}
    {% block header %}
    {% endblock header %}
    {% block main %}
        <div class="main-container">
            {% if manager.category is not same as(null) %}
                <h2>{{ 'Category'|trans }}: {{ manager.category.name }}</h2>
            {% endif %}
            {% if manager.category is not same as(null) %}
                {% if manager.category.parents|length > 0 %}
                    <p>{{ 'Categories'|trans }}
                        {% for category in manager.category.parents %}
                            <a href="{{ path('genealogy_category_modify', {category: category.name}) }}" target="_blank">{{ category.name }}</a>
                            {% if loop.index < manager.category.parents|length %}{{ ' | ' }}{% endif %}
                        {% endfor %}
                        <span {{ react_component('edit_parent_categories', {id: 'edit_parent_categories', title: 'Modify parent categories'|trans}) }}></span></p>
                {% endif %}
                </div>
                <div class="main-container">
                <h3>{{ 'Individual Profiles'|trans }}</h3>
                {% if manager.category.individuals|length < 1 %}
                    <p>{{ 'No individual profiles found for '|trans({name: manager.category.name}) }}</p>
                {% else %}
                    {% set count = (manager.category.individuals|length / 3)|force_to_int %}
                    {% if manager.category.individuals|length is not divisible by(3) %}{% set count = count + 1 %}{% endif %}
                    <div class="flexbox">
                        <div>
                            {% for individual in manager.category.individuals %}
                            <p style="padding-right: 3px"><strong><a href="{{ path('genealogy_record_modify', {individual: individual.userID}) }}" target="_blank">{{ manager.nameManager.shortName(individual) }}</a></strong>
                                {% if manager.nameManager.shortEventDate(individual, 'birth') is not same as('') %}
                                    {{ ' ' }}{{ manager.nameManager.shortEventDate(individual, 'birth') }}
                                {% endif %}
                                {% if individual.birthLocation is not same as('') %}
                                    {{ ' ' }}{{ individual.birthLocation }}
                                {% endif %}
                                {% if manager.nameManager.shortEventDate(individual, 'death') is not same as('') %}
                                    {{ ' - ' }}{{ manager.nameManager.shortEventDate(individual, 'death') }}
                                {% endif %}
                            </p>
                            {% if loop.index is divisible by(count) and loop.index is not same as(manager.category.individuals|length)  %}</div><div>{% endif %}
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            {% endif %}
        </div>
    {% endblock main %}
    {% block content %}
        <div id="category-content"></div>
    {% endblock content %}
{% block sidebar %}
    {% include 'genealogy/form/category_location.html.twig' with {identifier: location_form.vars.id ~ '_form', form: location_form, field: location_form.location} %}
    {% include 'genealogy/form/parent_category_manage.html.twig' with {identifier: parents_form.vars.id ~ '_form', form: parents_form, field: parents_form.parent} %}
    <p style="clear: both"><a href="https://www.wikitree.com/wiki/Category:{{ app.request.get('category')|replace({" ": "_", ",": "\%2C"}) }}" target="_blank">{{ app.request.get('category') }} {{ 'on Wikitree'|trans }}</a></p>
{% endblock sidebar %}
{% block javascripts %}
    {% set translations = {} %}
    {% set translations = translations|merge({Category: 'Category'|trans}) %}
    {% set translations = translations|merge({Categories: 'Categories'|trans}) %}
    {% set translations = translations|merge({'IndividualProfiles': 'Individual Profiles'|trans}) %}
    <script>
        window.CATEGORY_PROPS = [];
        window.CATEGORY_PROPS.category = {{ manager.categoryProps|json_encode|raw }};
        window.CATEGORY_PROPS.translations = {{ translations|json_encode|raw }};
    </script>

    {{ encore_entry_script_tags('category') }}
    {{ parent() }}
{% endblock %}
